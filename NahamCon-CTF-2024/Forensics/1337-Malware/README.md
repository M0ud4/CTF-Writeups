# 1337 Malware Writeup
This task is talking about what seems to be a network capture for a broken ransomware communication with it's C&C.
## Lets extract the ransomware code :
![alt text](assets/image.png)

The python script is pretty simple :

reads the files in certain path --> generate a random key --> encrypt the files and send them to C&C (Command and control)
![alt text](assets/image-1.png)

## Breaking the xor Implimentation:
Key here is a random 32 bytes.

We can see from the pcap that various files have been sent (pdf,png,zip,public key,private key), following it the enc content
![alt text](assets/image-2.png)

--> The idea here is to find a fixed 32 bytes header in any of this extensions so we can xor it with encrypted file and restore the key 

original ^ key = enc

enc ^ original = Key 

![alt text](assets/image-3.png)

As we can see here the ssh private key header is over 32 bytes , bingus 

Enc Sent Header :
![alt text](assets/image-4.png)

Look for scripts/xor_break.py to see how i recovered the key . 

Now simply you can try to decrypt the zip file : 

![alt text](assets/image-5.png)

We can see the flag.txt we need the password now , lets decrypt the pdf it may contain the password .

![alt text](assets/image-6.png)

## Extracting the flag 
![alt text](assets/image-8.png)
![alt text](assets/image-7.png)